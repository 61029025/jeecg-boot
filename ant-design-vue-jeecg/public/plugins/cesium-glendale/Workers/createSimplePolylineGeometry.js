define(["./when-54c2dc71","./Check-6c0211bc","./Math-fc8cecf5","./Cartesian3-e5933291","./WebGLConstants-76bb35d1","./ComponentDatatype-6d99a1ee","./Matrix4-a018fd55","./RuntimeError-2109023a","./Cartesian2-b1f4b655","./Transforms-b0e569fa","./GeometryAttribute-95a2a7cd","./GeometryAttributes-4fcfcf40","./IndexDatatype-53503fee","./IntersectionTests-9d7ddacd","./Plane-6e6a4f39","./ArcType-dc1c5aee","./EllipsoidRhumbLine-cdd4405f","./EllipsoidGeodesic-1a54c615","./PolylinePipeline-1acb3556","./Color-1850e670"],function(S,e,I,R,o,O,r,t,c,M,U,N,F,a,l,H,i,n,W,Y){"use strict";function f(e){var o=(e=S.defaultValue(e,S.defaultValue.EMPTY_OBJECT)).positions,r=e.colors,t=S.defaultValue(e.colorsPerVertex,!1);this._positions=o,this._colors=r,this._colorsPerVertex=t,this._arcType=S.defaultValue(e.arcType,H.ArcType.GEODESIC),this._granularity=S.defaultValue(e.granularity,I.CesiumMath.RADIANS_PER_DEGREE),this._ellipsoid=S.defaultValue(e.ellipsoid,c.Ellipsoid.WGS84),this._workerName="createSimplePolylineGeometry";var a=1+o.length*R.Cartesian3.packedLength;a+=S.defined(r)?1+r.length*Y.Color.packedLength:1,this.packedLength=a+c.Ellipsoid.packedLength+3}f.pack=function(e,o,r){var t;r=S.defaultValue(r,0);var a=e._positions,l=a.length;for(o[r++]=l,t=0;t<l;++t,r+=R.Cartesian3.packedLength)R.Cartesian3.pack(a[t],o,r);var i=e._colors,l=S.defined(i)?i.length:0;for(o[r++]=l,t=0;t<l;++t,r+=Y.Color.packedLength)Y.Color.pack(i[t],o,r);return c.Ellipsoid.pack(e._ellipsoid,o,r),r+=c.Ellipsoid.packedLength,o[r++]=e._colorsPerVertex?1:0,o[r++]=e._arcType,o[r]=e._granularity,o},f.unpack=function(e,o,r){o=S.defaultValue(o,0);for(var t=e[o++],a=new Array(t),l=0;l<t;++l,o+=R.Cartesian3.packedLength)a[l]=R.Cartesian3.unpack(e,o);var i=0<(t=e[o++])?new Array(t):void 0;for(l=0;l<t;++l,o+=Y.Color.packedLength)i[l]=Y.Color.unpack(e,o);var n=c.Ellipsoid.unpack(e,o);o+=c.Ellipsoid.packedLength;var s=1===e[o++],p=e[o++],d=e[o];return S.defined(r)?(r._positions=a,r._colors=i,r._ellipsoid=n,r._colorsPerVertex=s,r._arcType=p,r._granularity=d,r):new f({positions:a,colors:i,ellipsoid:n,colorsPerVertex:s,arcType:p,granularity:d})};var q=new Array(2),z=new Array(2),J={positions:q,height:z,ellipsoid:void 0,minDistance:void 0,granularity:void 0};return f.createGeometry=function(e){var o,r,t,a=e._positions,l=e._colors,i=e._colorsPerVertex,n=e._arcType,s=e._granularity,p=e._ellipsoid,d=I.CesiumMath.chordLength(s,p.maximumRadius),c=S.defined(l)&&!i,f=a.length,y=0;if(n===H.ArcType.GEODESIC||n===H.ArcType.RHUMB){var u,h,C=n===H.ArcType.GEODESIC?(u=I.CesiumMath.chordLength(s,p.maximumRadius),h=W.PolylinePipeline.numberOfPoints,W.PolylinePipeline.generateArc):(u=s,h=W.PolylinePipeline.numberOfPointsRhumbLine,W.PolylinePipeline.generateRhumbArc),T=W.PolylinePipeline.extractHeights(a,p),g=J;if(n===H.ArcType.GEODESIC?g.minDistance=d:g.granularity=s,g.ellipsoid=p,c){for(var m=0,v=0;v<f-1;v++)m+=h(a[v],a[v+1],u)+1;o=new Float64Array(3*m),t=new Uint8Array(4*m),g.positions=q,g.height=z;var P=0;for(v=0;v<f-1;++v){q[0]=a[v],q[1]=a[v+1],z[0]=T[v],z[1]=T[v+1];var _=C(g);if(S.defined(l))for(var b=_.length/3,B=l[v],A=0;A<b;++A)t[P++]=Y.Color.floatToByte(B.red),t[P++]=Y.Color.floatToByte(B.green),t[P++]=Y.Color.floatToByte(B.blue),t[P++]=Y.Color.floatToByte(B.alpha);o.set(_,y),y+=_.length}}else if(g.positions=a,g.height=T,o=new Float64Array(C(g)),S.defined(l)){for(t=new Uint8Array(o.length/3*4),v=0;v<f-1;++v)y=function(e,o,r,t,a,l,i){var n=W.PolylinePipeline.numberOfPoints(e,o,a),s=r.red,p=r.green,d=r.blue,c=r.alpha,f=t.red,y=t.green,u=t.blue,h=t.alpha;if(Y.Color.equals(r,t)){for(P=0;P<n;P++)l[i++]=Y.Color.floatToByte(s),l[i++]=Y.Color.floatToByte(p),l[i++]=Y.Color.floatToByte(d),l[i++]=Y.Color.floatToByte(c);return i}for(var C=(f-s)/n,T=(y-p)/n,g=(u-d)/n,m=(h-c)/n,v=i,P=0;P<n;P++)l[v++]=Y.Color.floatToByte(s+P*C),l[v++]=Y.Color.floatToByte(p+P*T),l[v++]=Y.Color.floatToByte(d+P*g),l[v++]=Y.Color.floatToByte(c+P*m);return v}(a[v],a[v+1],l[v],l[v+1],d,t,y);var E=l[f-1];t[y++]=Y.Color.floatToByte(E.red),t[y++]=Y.Color.floatToByte(E.green),t[y++]=Y.Color.floatToByte(E.blue),t[y++]=Y.Color.floatToByte(E.alpha)}}else{r=c?2*f-2:f,o=new Float64Array(3*r),t=S.defined(l)?new Uint8Array(4*r):void 0;var k=0,G=0;for(v=0;v<f;++v){var w=a[v];if(c&&0<v&&(R.Cartesian3.pack(w,o,k),k+=3,B=l[v-1],t[G++]=Y.Color.floatToByte(B.red),t[G++]=Y.Color.floatToByte(B.green),t[G++]=Y.Color.floatToByte(B.blue),t[G++]=Y.Color.floatToByte(B.alpha)),c&&v===f-1)break;R.Cartesian3.pack(w,o,k),k+=3,S.defined(l)&&(B=l[v],t[G++]=Y.Color.floatToByte(B.red),t[G++]=Y.Color.floatToByte(B.green),t[G++]=Y.Color.floatToByte(B.blue),t[G++]=Y.Color.floatToByte(B.alpha))}}var D=new N.GeometryAttributes;D.position=new U.GeometryAttribute({componentDatatype:O.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:o}),S.defined(l)&&(D.color=new U.GeometryAttribute({componentDatatype:O.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:t,normalize:!0}));var L=2*((r=o.length/3)-1),V=F.IndexDatatype.createTypedArray(r,L),x=0;for(v=0;v<r-1;++v)V[x++]=v,V[x++]=v+1;return new U.Geometry({attributes:D,indices:V,primitiveType:U.PrimitiveType.LINES,boundingSphere:M.BoundingSphere.fromPoints(a)})},function(e,o){return S.defined(o)&&(e=f.unpack(e,o)),e._ellipsoid=c.Ellipsoid.clone(e._ellipsoid),f.createGeometry(e)}});
