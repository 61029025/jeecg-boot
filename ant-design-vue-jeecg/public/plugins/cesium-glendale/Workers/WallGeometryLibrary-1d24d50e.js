define(["exports","./when-54c2dc71","./Math-fc8cecf5","./Cartesian3-e5933291","./Cartesian2-b1f4b655","./arrayRemoveDuplicates-ebc732b0","./PolylinePipeline-1acb3556"],function(e,P,C,A,w,b,M){"use strict";var i={};var E=new w.Cartographic,F=new w.Cartographic;function H(e,i,t,r){var a=(i=b.arrayRemoveDuplicates(i,A.Cartesian3.equalsEpsilon)).length;if(!(a<2)){var n=P.defined(r),o=P.defined(t),s=new Array(a),l=new Array(a),h=new Array(a),g=i[0];s[0]=g;var c=e.cartesianToCartographic(g,E);o&&(c.height=t[0]),l[0]=c.height,h[0]=n?r[0]:0;for(var p,u,d=l[0]===h[0],v=1,y=1;y<a;++y){var f=i[y],m=e.cartesianToCartographic(f,F);o&&(m.height=t[y]),d=d&&0===m.height,p=c,u=m,C.CesiumMath.equalsEpsilon(p.latitude,u.latitude,C.CesiumMath.EPSILON10)&&C.CesiumMath.equalsEpsilon(p.longitude,u.longitude,C.CesiumMath.EPSILON10)?c.height<m.height&&(l[v-1]=m.height):(s[v]=f,l[v]=m.height,h[v]=n?r[y]:0,d=d&&l[v]===h[v],w.Cartographic.clone(m,c),++v)}if(!(d||v<2))return s.length=v,l.length=v,h.length=v,{positions:s,topHeights:l,bottomHeights:h}}}var L=new Array(2),q=new Array(2),D={positions:void 0,height:void 0,granularity:void 0,ellipsoid:void 0};i.computePositions=function(e,i,t,r,a,n){var o=H(e,i,t,r);if(P.defined(o)){i=o.positions,t=o.topHeights,r=o.bottomHeights;var s,l,h=i.length,g=h-2,c=C.CesiumMath.chordLength(a,e.maximumRadius),p=D;if(p.minDistance=c,p.ellipsoid=e,n){for(var u=0,d=0;d<h-1;d++)u+=M.PolylinePipeline.numberOfPoints(i[d],i[d+1],c)+1;s=new Float64Array(3*u),l=new Float64Array(3*u);var v=L,y=q;p.positions=v,p.height=y;var f=0;for(d=0;d<h-1;d++){v[0]=i[d],v[1]=i[d+1],y[0]=t[d],y[1]=t[d+1];var m=M.PolylinePipeline.generateArc(p);s.set(m,f),y[0]=r[d],y[1]=r[d+1],l.set(M.PolylinePipeline.generateArc(p),f),f+=m.length}}else p.positions=i,p.height=t,s=new Float64Array(M.PolylinePipeline.generateArc(p)),p.height=r,l=new Float64Array(M.PolylinePipeline.generateArc(p));return{bottomPositions:l,topPositions:s,numCorners:g}}},e.WallGeometryLibrary=i});
