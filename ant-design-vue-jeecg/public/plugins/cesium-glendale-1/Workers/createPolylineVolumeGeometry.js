define(["./when-54c2dc71","./Check-6c0211bc","./Math-fc8cecf5","./Cartesian3-e5933291","./WebGLConstants-76bb35d1","./ComponentDatatype-6d99a1ee","./Cartesian2-062e3760","./Transforms-7e4f9763","./RuntimeError-2109023a","./GeometryAttribute-8f568314","./GeometryAttributes-4fcfcf40","./AttributeCompression-c2280b36","./GeometryPipeline-18f4aa75","./EncodedCartesian3-48cbf07c","./IndexDatatype-53503fee","./IntersectionTests-3bd26a70","./Plane-1b056faf","./VertexFormat-7572c785","./arrayRemoveDuplicates-ebc732b0","./BoundingRectangle-148267cb","./EllipsoidTangentPlane-49bc3591","./EllipsoidRhumbLine-db1dc7f1","./PolygonPipeline-143466d4","./PolylineVolumeGeometryLibrary-a24b2c73","./EllipsoidGeodesic-86b7846e","./PolylinePipeline-7f74434e"],function(A,e,a,M,t,D,u,I,n,z,O,r,B,i,S,o,l,m,s,p,d,c,H,y,g,h){"use strict";var f={};function N(e,t){A.defined(f[e])||(f[e]=!0,console.warn(A.defaultValue(t,e)))}function v(e,t,n,r,i){var a=new O.GeometryAttributes;r.position&&(a.position=new z.GeometryAttribute({componentDatatype:D.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:e}));var o,l,s,p,d,c=t.length,u=e.length/3,m=(u-2*c)/(2*c),y=H.PolygonPipeline.triangulate(t),g=(m-1)*c*6+2*y.length,h=S.IndexDatatype.createTypedArray(u,g),f=2*c,v=0;for(C=0;C<m-1;C++){for(o=0;o<c-1;o++)d=(l=2*o+C*c*2)+f,p=(s=l+1)+f,h[v++]=s,h[v++]=l,h[v++]=p,h[v++]=p,h[v++]=l,h[v++]=d;p=(s=(l=2*c-2+C*c*2)+1)+f,d=l+f,h[v++]=s,h[v++]=l,h[v++]=p,h[v++]=p,h[v++]=l,h[v++]=d}if(r.st||r.tangent||r.bitangent){for(var b,x,_=new Float32Array(2*u),E=1/(m-1),P=1/n.height,T=n.height/2,w=0,C=0;C<m;C++){for(b=C*E,x=P*(t[0].y+T),_[w++]=b,_[w++]=x,o=1;o<c;o++)x=P*(t[o].y+T),_[w++]=b,_[w++]=x,_[w++]=b,_[w++]=x;x=P*(t[0].y+T),_[w++]=b,_[w++]=x}for(o=0;o<c;o++)b=0,x=P*(t[o].y+T),_[w++]=b,_[w++]=x;for(o=0;o<c;o++)b=(m-1)*E,x=P*(t[o].y+T),_[w++]=b,_[w++]=x;a.st=new z.GeometryAttribute({componentDatatype:D.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:new Float32Array(_)})}var k=u-2*c;for(C=0;C<y.length;C+=3){var V=y[C]+k,L=y[C+1]+k,F=y[C+2]+k;h[v++]=V,h[v++]=L,h[v++]=F,h[v++]=F+c,h[v++]=L+c,h[v++]=V+c}var G=function(e,t){var n=[],r=new I.Matrix4;A.defined(t)&&!t.equals(new I.Matrix4)&&I.Matrix4.inverse(t,r);for(var i=0;i<e.length/3;i++){var a=new M.Cartesian3(e[3*i],e[3*i+1],e[3*i+2]);I.Matrix4.multiplyByPoint(r,a,a),n.push(a.x,a.y,a.z)}for(var o=new M.Cartesian3(-1/0,-1/0,-1/0),l=new M.Cartesian3(1/0,1/0,1/0),s=0;s<n.length/3;s++){var p=new M.Cartesian3(n[3*s],n[3*s+1],n[3*s+2]);o.x=Math.max(o.x,p.x),o.y=Math.max(o.y,p.y),o.z=Math.max(o.z,p.z),l.x=Math.min(l.x,p.x),l.y=Math.min(l.y,p.y),l.z=Math.min(l.z,p.z)}return[o,l]}(e,i),R=new z.Geometry({attributes:a,indices:h,boundingSphere:I.BoundingSphere.fromVertices(e),MaxPoint:G[0],MinPoint:G[1],primitiveType:z.PrimitiveType.TRIANGLES});if(r.normal&&(R=B.GeometryPipeline.computeNormal(R,i)),r.tangent||r.bitangent){try{R=B.GeometryPipeline.computeTangentAndBitangent(R)}catch(e){N("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}r.tangent||(R.attributes.tangent=void 0),r.bitangent||(R.attributes.bitangent=void 0),r.st||(R.attributes.st=void 0)}return R}function b(e){var t,n=(e=A.defaultValue(e,A.defaultValue.EMPTY_OBJECT)).polylinePositions,r=e.shapePositions;this._positions=n,this._shape=r,this._ellipsoid=u.Ellipsoid.clone(A.defaultValue(e.ellipsoid,u.Ellipsoid.WGS84)),this._cornerType=A.defaultValue(e.cornerType,y.CornerType.ROUNDED),this._vertexFormat=m.VertexFormat.clone(A.defaultValue(e.vertexFormat,m.VertexFormat.DEFAULT)),this._granularity=A.defaultValue(e.granularity,a.CesiumMath.RADIANS_PER_DEGREE),A.defined(e.id)&&(t=e.id._polylineVolume.RootTransform,this._rootTransform=t),e.rootTransform&&(this._rootTransform=e.rootTransform),this._workerName="createPolylineVolumeGeometry";var i=1+n.length*M.Cartesian3.packedLength;i+=1+r.length*u.Cartesian2.packedLength,A.defined(t)&&(i+=1+t.length),this.packedLength=i+u.Ellipsoid.packedLength+m.VertexFormat.packedLength+2}N.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",N.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored",N.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored",N.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored",b.pack=function(e,t,n){var r;n=A.defaultValue(n,0);var i=e._positions,a=i.length;for(t[n++]=a,r=0;r<a;++r,n+=M.Cartesian3.packedLength)M.Cartesian3.pack(i[r],t,n);var o=e._shape,a=o.length;for(t[n++]=a,r=0;r<a;++r,n+=u.Cartesian2.packedLength)u.Cartesian2.pack(o[r],t,n);u.Ellipsoid.pack(e._ellipsoid,t,n),n+=u.Ellipsoid.packedLength,m.VertexFormat.pack(e._vertexFormat,t,n),n+=m.VertexFormat.packedLength,t[n++]=e._cornerType,t[n++]=e._granularity;var l=e._rootTransform;return A.defined(l)&&I.Matrix4.pack(l,t,n++),t};var x=u.Ellipsoid.clone(u.Ellipsoid.UNIT_SPHERE),_=new m.VertexFormat,E={polylinePositions:void 0,shapePositions:void 0,ellipsoid:x,vertexFormat:_,cornerType:void 0,granularity:void 0};b.unpack=function(e,t,n){t=A.defaultValue(t,0);for(var r=e[t++],i=new Array(r),a=0;a<r;++a,t+=M.Cartesian3.packedLength)i[a]=M.Cartesian3.unpack(e,t);r=e[t++];var o=new Array(r);for(a=0;a<r;++a,t+=u.Cartesian2.packedLength)o[a]=u.Cartesian2.unpack(e,t);var l=u.Ellipsoid.unpack(e,t,x);t+=u.Ellipsoid.packedLength;var s=m.VertexFormat.unpack(e,t,_);t+=m.VertexFormat.packedLength;var p=e[t++],d=e[t++],c=new I.Matrix4;return e.length>t&&I.Matrix4.unpack(e,t++,c),A.defined(n)?(n._positions=i,n._shape=o,n._ellipsoid=u.Ellipsoid.clone(l,n._ellipsoid),n._vertexFormat=m.VertexFormat.clone(s,n._vertexFormat),n._cornerType=p,n._granularity=d,n._rootTransform=c,n):(E.polylinePositions=i,E.shapePositions=o,E.cornerType=p,E.granularity=d,E.rootTransform=c,new b(E))};var P=new p.BoundingRectangle;return b.createGeometry=function(e){var t=e._positions,n=s.arrayRemoveDuplicates(t,M.Cartesian3.equalsEpsilon),r=e._shape,r=y.PolylineVolumeGeometryLibrary.removeDuplicatesFromShape(r);if(!(n.length<2||r.length<3)){H.PolygonPipeline.computeWindingOrder2D(r)===H.WindingOrder.CLOCKWISE&&r.reverse();var i=p.BoundingRectangle.fromPoints(r,P);return v(y.PolylineVolumeGeometryLibrary.computePositions(n,r,i,e,!0),r,i,e._vertexFormat,e._rootTransform)}},function(e,t){return A.defined(t)&&(e=b.unpack(e,t)),e._ellipsoid=u.Ellipsoid.clone(e._ellipsoid),b.createGeometry(e)}});
